<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Skin</title>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

    <!-- Bootstrap & Font Awesome -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">

    <!-- Custom CSS -->
    <style>
        /* Global Styles */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #600b0b;
            color: #fff;
            margin: 0;
            padding: 20px;
        }

        header {
            background: linear-gradient(90deg, #6a0000, #b22222);
            color: white;
            padding: 10px 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        header a#logo img {
            height: 50px;
        }

        /* Layout */
        .main-content {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        /* Form Container as Table */
        .form-container {
            width: 50%;
            background: #b22222;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            padding: 20px;
        }

        .form-container table {
            width: 100%;
            border-collapse: collapse;
        }

        .form-container table th,
        .form-container table td {
            border: 1px solid #fff;
            padding: 10px;
            text-align: left;
        }

        .form-container table th {
            background-color: #6a0000;
            color: white;
            text-transform: uppercase;
        }

        .form-container input[type="file"] {
            margin-top: 10px;
            margin-bottom: 15px;
        }

        .form-container button {
            display: block;
            margin: 0 auto;
            padding: 10px 20px;
            background-color: #000;
            border: none;
            color: white;
            font-size: 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .form-container button:hover {
            background-color: #28a745;
        }

        /* User Panel */
        .user-panel {
            width: 30%;
            background: #6a0000;
            color: white;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            padding: 20px;
            text-align: center;
        }

        .user-panel img {
            border: 3px solid #b22222;
            border-radius: 50%;
            width: 128px;
            height: 128px;
        }

        .user-panel h4 {
            margin: 15px 0 5px;
        }

        .user-panel button {
            background: white;
            color: #8b0000;
            border: 2px solid #8b0000;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.3s ease;
        }

        .user-panel button:hover {
            background: #8b0000;
            color: white;
        }
.user-panel .user-uploads-display {
    font-size: 1rem;
    margin-top: 10px;
    display: block;
    font-weight: bold;
}

.user-panel .user-coins {
    color: #28a745;  /* Màu xanh */
}
 .yellow-text {
            color: yellow;
        }
    </style>
</head>

<body>
    <header>
        <a href="#" id="logo">
            <img src="dclogo.png" alt="Logo">
        </a>
    </header>

    <div class="main-content">
        <div class="form-container">
            <h3 class="text-center">Upload Your Skin</h3>
            <table>
                <tr>
                    <th>Skin Type</th>
                    <td>
                        <input type="file" name="image1" id="singleFileUploadInput" accept="image/png" required>
                    </td>
                </tr>
            </table>

            <div type="center" class="image-preview" id="imagePreview">
            </div>
            <br>
            <button type="submit" name="submit" class="btn btn-success btn-md submit-btn" name="submit">Submit</button>
        </div>

        <div class="user-panel">
            <img src="user.png" alt="User">
            <h4 class="user-name">User Name</h4>
            <h5  class="user-uploads-display">ID: <span class="user-id"></h5>
		    <h6 class="user-uploads-display">Bạn còn <span class="user-coins">0</span> lượt uploads</h6>
            <a id="button" href="/napthe" type="button" class="btn btn-success btn-md">Ủng Hộ</a>
        </div>
    </div>
<center>
  <div class="modal-body">
    <p>
      Vui lòng đảm bảo rằng ảnh bạn tải lên không chứa nội dung đồi trụy hoặc vi phạm pháp luật. Việc tải lên nội dung vi phạm có thể dẫn đến các biện pháp xử lý theo quy định của pháp luật.
    </p>
    <p>
      <strong>Lưu ý:</strong> Việc phát tán nội dung đồi trụy trên mạng có thể bị xử phạt hành chính hoặc hình sự theo quy định của pháp luật <span class="yellow-text" style="white-space: nowrap;">Việt Nam</span>.
    </p>
  </div>
  
</center>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
</body>
<script src="btw.js"></script>
<script>
(()=>{let e,t;$("#singleFileUploadInput").on("change",(function(){const e=this.files[0],t=new FileReader,n=document.getElementById("imagePreview");e?(t.onload=function(e){const t=new Image;t.src=e.target.result,t.onload=function(){const t=document.createElement("img");t.src=e.target.result,t.alt="Image Preview",t.style.width="512px",t.style.height="512px",t.style.borderRadius="50%",n.innerHTML="",n.appendChild(t)}},t.readAsDataURL(e)):n.innerHTML=""})),$("button.submit-btn").on("click",(function(t){t.preventDefault();const r=$("#singleFileUploadInput")[0];if(!r.files||!r.files.length)return alert("Vui lòng chọn file!");const a=r.files[0];if("image/png"!==a.type)return alert("Chỉ hỗ trợ file PNG!");if(a.size>5e6)return alert("Tối đa dung lượng file 5MB");const s=(e=>{const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";return Array.from({length:e},(()=>t.charAt(Math.floor(62*Math.random())))).join("")+".png"})(12),o=new FormData;o.append("skin",new File([a],s,{type:"image/png"})),o.append("user_id",e),function(e){return new Promise(((t,n)=>{$.ajax({url:"/ajax/update_coins.php",method:"GET",data:{user_id:e},dataType:"json",success:function(e){"success"===e.status?t(e.coins):n(e.message)},error:function(){n("Có lỗi xảy ra khi lấy thông tin số dư coin.")}})}))}(e).then((e=>{e>0?n(o):alert("Không đủ lượt để upload!")})).catch((e=>{alert(e)}))}));const n=e=>{$.ajax({url:"ajax/upload_skin.php",method:"POST",data:e,contentType:!1,processData:!1,success:e=>{try{if(JSON.parse(e).upload){alert("Uploads thành công...! ");location.reload()}}catch(e){console.error("Upload response error:",e)}},error:(e,t,n)=>console.error("Upload error:",t,n)})};handleAuthenticate((n=>{n?($(".user-name").text(n.username),$(".user-coins").text(n.coins),$(".user-id").text("ID:"),$(".user-id").text(n.id),$(".user-coins").text("Bạn còn"),n.active_image_path&&$(".user-skin").attr("src",n.active_image_path),e=n.id,t=n.coins,$.ajax({url:"ajax/update_coins.php",type:"POST",data:{user_id:e},success:e=>{try{const t=JSON.parse(e);"success"===t.status?$(".user-coins").text(t.coins):console.error("Lỗi:",t.message)}catch(e){console.error("JSON parse error:",e)}},error:()=>alert("Có lỗi khi lấy số coin.")})):console.error("payload throw failed!")}))})();
</script>

</html>
